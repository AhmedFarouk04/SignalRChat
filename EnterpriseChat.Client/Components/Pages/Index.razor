@page "/"

@attribute [Microsoft.AspNetCore.Authorization.AllowAnonymous]

@inject NavigationManager Nav
@inject AuthenticationStateProvider AuthState

@{
    // هنا الكود بيشتغل async داخل بلوك RenderFragment
    _ = CheckAuthAndRedirect();
}

<div style="text-align:center; padding:100px 20px;">
    <h1>Redirecting...</h1>
    <p>Please wait while we check your login status...</p>
</div>

@code {
    private async Task CheckAuthAndRedirect()
    {
        var authState = await AuthState.GetAuthenticationStateAsync();
        var user = authState.User;

        if (user.Identity?.IsAuthenticated == true)
        {
            Nav.NavigateTo("/rooms");
        }
        else
        {
            Nav.NavigateTo("/login");
        }
    }
}