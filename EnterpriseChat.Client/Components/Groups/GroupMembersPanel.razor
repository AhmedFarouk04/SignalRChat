@using EnterpriseChat.Client.Models

<div class="group-panel">
    <h4>Members</h4>

    @foreach (var member in Members)
    {
        var displayName = string.IsNullOrWhiteSpace(member.DisplayName)
        ? "User " + member.Id.ToString().Substring(0, 6)
        : member.DisplayName;

        <div class="member-row">
            <span class="avatar">
                @(string.IsNullOrWhiteSpace(member.DisplayName) ? "?" : member.DisplayName[..1].ToUpper())
            </span>
            <span>@displayName</span>
            @if (member.Id == OwnerId)
            {
                <span class="badge owner">Owner</span>
            }
            @if (CanManageMembers && member.Id != OwnerId)
            {
                <button @onclick="() => OnRemove.InvokeAsync(member.Id)">
                    Remove
                </button>
            }
        </div>
    }

    @if (CanLeaveGroup)
    {
        <button class="leave-btn"
                @onclick="OnLeave">
            Leave group
        </button>
    }
</div>

@code {
    [Parameter] public Guid OwnerId { get; set; }
    [Parameter] public IReadOnlyList<UserModel> Members { get; set; } = [];
    [Parameter] public EventCallback<Guid> OnRemove { get; set; }
    [Parameter] public EventCallback OnLeave { get; set; }

    [Parameter] public bool CanManageMembers { get; set; }
    [Parameter] public bool CanLeaveGroup { get; set; }
}
