<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat.Client</title>
    <base href="/" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="EnterpriseChat.Client.styles.css" rel="stylesheet" />
</head>
<body>
    <div id="app">
        <div class="loading-screen">
            <svg class="loading-progress">
                <circle r="40%" cx="50%" cy="50%" />
                <circle r="40%" cx="50%" cy="50%" />
            </svg>
            <div class="loading-progress-text"></div>
        </div>
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>

    <script src="_framework/blazor.webassembly.js"></script>

    <script type="module">
        import { scrollToBottom, scrollToBottomSmooth, isAtBottom, registerRoomsSearchShortcuts } from './js/scroll.js';
        import { registerEscape, unregisterEscape } from './js/keyboard.js';
        import { downloadFileFromStream } from './js/download.js';
        import * as chatInput from './js/chatInput.js';
        import { initNotifySound, playNotify, unlockNotify } from './js/notify.js';

        // âœ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        import './js/chat-utils.js';

        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¯ÙˆØ§Ù„ Ø¹Ù„Ù‰ window
        window.chatInsertNewline = chatInput.chatInsertNewline || chatInsertNewline;

        // âœ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        window.chatFocus = window.focusElement || chatInput.focusEl || chatInput.focus;

        window.scrollToBottom = scrollToBottom;
        window.scrollToBottomSmooth = scrollToBottomSmooth;
        window.isAtBottom = isAtBottom;
        window.registerRoomsSearchShortcuts = registerRoomsSearchShortcuts;

        window.registerEscape = registerEscape;
        window.unregisterEscape = unregisterEscape;

        window.downloadFileFromStream = downloadFileFromStream;

        initNotifySound('/sounds/notify.mp3');
        window.notifyUnlock = unlockNotify;
        window.notifyPlay = playNotify;

        // âœ… ØªØ¹ÙŠÙŠÙ† Ø¯ÙˆØ§Ù„ Ø¥Ø¶Ø§ÙÙŠØ©
      // âœ… ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØ¬Ø¹Ù„Ù‡Ø§ ÙÙŠ Ù…Ù†ØªØµÙ Ø§Ù„Ø´Ø§Ø´Ø©
window.scrollToMessage = (id) => {
    const el = document.getElementById(id);
    if (el) {
        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
};

// âœ… ØªÙ†ÙÙŠØ° Ø§Ù„ÙˆÙ…ÙŠØ¶ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙ„Ø§Ø³ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡ ÙÙŠ Ø§Ù„Ù€ CSS
window.highlightMessage = (id) => {
    const el = document.getElementById(id);
    if (el) {
        // Ù†Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù„ÙŠ ÙÙŠ Ø§Ù„Ù€ CSS
        el.classList.add('highlight-flash'); 
        
        // Ù†Ø´ÙŠÙ„Ù‡ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ† (Ù…Ø¯Ø© Ø§Ù„Ø£Ù†Ù…ÙŠØ´Ù†)
        setTimeout(() => {
            el.classList.remove('highlight-flash');
        }, 2000);
    }
};
    </script>
</body>
</html>